import { Scenario } from '../model/GiftModel';
import router from '@ohos.router';

// åœºæ™¯ä¿¡æ¯æŽ¥å£
interface ScenarioInfo {
  key: Scenario;
  name: string;
  icon: string;
  description: string;
  color: string;
  tips: string[];
}

@Entry
@Component
struct ScenarioListPage {
  // åœºæ™¯æ•°æ®
  private scenarios: ScenarioInfo[] = [
    {
      key: Scenario.BIRTHDAY,
      name: 'ç”Ÿæ—¥ç¤¼ç‰©',
      icon: 'ðŸŽ‚',
      description: 'ä¸ºç”Ÿæ—¥åº†ç¥æŒ‘é€‰å®Œç¾Žç¤¼ç‰©',
      color: '#FF6B6B',
      tips: ['æ ¹æ®å¹´é¾„é€‰æ‹©', 'è€ƒè™‘ä¸ªäººå…´è¶£', 'æ³¨é‡çºªå¿µæ„ä¹‰']
    },
    {
      key: Scenario.VALENTINE,
      name: 'æƒ…äººèŠ‚',
      icon: 'ðŸ’',
      description: 'è¡¨è¾¾çˆ±æ„çš„æµªæ¼«ç¤¼ç‰©',
      color: '#E91E63',
      tips: ['æµªæ¼«ä¸ºä¸»', 'ä¸ªæ€§åŒ–å®šåˆ¶', 'æƒ…æ„Ÿä»·å€¼é‡äºŽä»·æ ¼']
    },
    {
      key: Scenario.ANNIVERSARY,
      name: 'çºªå¿µæ—¥',
      icon: 'ðŸ’',
      description: 'çºªå¿µé‡è¦æ—¶åˆ»çš„ç‰¹æ®Šç¤¼ç‰©',
      color: '#9C27B0',
      tips: ['çºªå¿µæ„ä¹‰', 'ä¿å­˜ä»·å€¼', 'æƒ…æ„Ÿå…±é¸£']
    },
    {
      key: Scenario.CHRISTMAS,
      name: 'åœ£è¯žèŠ‚',
      icon: 'ðŸŽ„',
      description: 'æ¸©é¦¨èŠ‚æ—¥çš„æ¬¢ä¹ç¤¼ç‰©',
      color: '#4CAF50',
      tips: ['èŠ‚æ—¥æ°›å›´', 'å®¶åº­æ¸©é¦¨', 'åˆ†äº«å¿«ä¹']
    },
    {
      key: Scenario.GRADUATION,
      name: 'æ¯•ä¸šç¤¼ç‰©',
      icon: 'ðŸŽ“',
      description: 'åº†ç¥å­¦ä¸šæˆå°±çš„åŠ±å¿—ç¤¼ç‰©',
      color: '#2196F3',
      tips: ['å®žç”¨æ€§å¼º', 'åŠ±å¿—æ„ä¹‰', 'æœªæ¥å¯¼å‘']
    },
    {
      key: Scenario.WEDDING,
      name: 'å©šç¤¼ç¤¼ç‰©',
      icon: 'ðŸ’’',
      description: 'ç¥ç¦æ–°äººçš„ç¾Žå¥½ç¤¼ç‰©',
      color: '#FF9800',
      tips: ['æˆåŒæˆå¯¹', 'å®žç”¨å®¶å±…', 'ç¾Žå¥½å¯“æ„']
    },
    {
      key: Scenario.THANK_YOU,
      name: 'æ„Ÿè°¢ç¤¼ç‰©',
      icon: 'ðŸ™',
      description: 'è¡¨è¾¾æ„Ÿæ¿€ä¹‹æƒ…çš„è´´å¿ƒç¤¼ç‰©',
      color: '#607D8B',
      tips: ['å¿ƒæ„ä¸ºé‡', 'å®žç”¨è´´å¿ƒ', 'ä¸å®œè¿‡è´µ']
    },
    {
      key: Scenario.APOLOGY,
      name: 'é“æ­‰ç¤¼ç‰©',
      icon: 'ðŸŒ¹',
      description: 'è¡¨è¾¾æ­‰æ„çš„è¯šæ„ç¤¼ç‰©',
      color: '#795548',
      tips: ['è¯šæ„ä¸ºå…ˆ', 'å¯¹æ–¹å–œå¥½', 'é€‚åº¦ä»·å€¼']
    }
  ];

  build() {
    Column() {
      // æ ‡é¢˜æ 
      this.buildHeader()
      
      // åœºæ™¯é€‰æ‹©é¡µ
      this.buildScenarioGrid()
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5')
  }

  @Builder
  buildHeader() {
    Row() {
      Button() {
        Image($r('app.media.icon_back'))
          .width(24)
          .height(24)
          .fillColor('#333333')
      }
      .width(40)
      .height(40)
      .backgroundColor(Color.Transparent)
      .onClick(() => {
        router.back();
      })
      
      Text('åœºæ™¯åˆ†ç±»')
        .fontSize(18)
        .fontWeight(FontWeight.Medium)
        .fontColor('#333333')
        .layoutWeight(1)
        .textAlign(TextAlign.Center)
      
      Blank().width(40)
    }
    .width('100%')
    .justifyContent(FlexAlign.SpaceBetween)
    .padding({ left: 16, right: 16, top: 12, bottom: 12 })
    .backgroundColor(Color.White)
  }

  @Builder
  buildScenarioGrid() {
    Column() {
      Text('é€‰æ‹©é€ç¤¼åœºæ™¯')
        .fontSize(14)
        .fontWeight(FontWeight.Medium)
        .fontColor('#666666')
        .margin({ top: 20, bottom: 20 })
      
      Grid() {
        ForEach(this.scenarios, (scenario: ScenarioInfo) => {
          GridItem() {
            this.buildScenarioCard(scenario)
          }
        }, (scenario: ScenarioInfo) => scenario.key.toString())
      }
      .columnsTemplate('1fr 1fr')
      .rowsGap(16)
      .columnsGap(16)
      .width('90%')
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Start)
    .alignItems(HorizontalAlign.Center)
  }

  @Builder
  buildScenarioCard(scenario: ScenarioInfo) {
    Column() {
      Text(scenario.icon)
        .fontSize(40)
        .margin({ bottom: 12 })
      
      Text(scenario.name)
        .fontSize(16)
        .fontWeight(FontWeight.Bold)
        .fontColor(Color.White)
        .margin({ bottom: 8 })
      
      Text(scenario.description)
        .fontSize(12)
        .fontColor(Color.White)
        .textAlign(TextAlign.Center)
        .opacity(0.9)
        .lineHeight(16)
        .maxLines(2)
        .textOverflow({ overflow: TextOverflow.Ellipsis })
    }
    .width('100%')
    .height(140)
    .backgroundColor(scenario.color)
    .borderRadius(16)
    .justifyContent(FlexAlign.Center)
    .alignItems(HorizontalAlign.Center)
    .padding(16)
    .onClick(() => {
      // è·³è½¬åˆ°ç¤¼ç‰©åˆ—è¡¨é¡µé¢ï¼Œä¼ é€’é€‰ä¸­çš„åœºæ™¯
      router.pushUrl({
        url: 'pages/ScenarioPage',
        params: {
          scenario: scenario.key,
          scenarioName: scenario.name
        }
      }).catch((error: Error) => {
        console.error('Failed to navigate to ScenarioPage:', error);
      });
    })
  }
}