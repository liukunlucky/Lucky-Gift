import router from '@ohos.router';
import { Inspiration } from '../../model/NewDataModels';
import { InspirationDAO } from '../../database/InspirationDAO';
import { NewDatabaseManager } from '../../database/NewDatabaseManager';
import { InspirationDataInitializer } from '../../database/InspirationDataInitializer';

// å¿«é€Ÿç­›é€‰å™¨æŽ¥å£
interface QuickFilter {
  label: string;
  type: string;
  value: string;
}

// åˆ†ç±»å¯¼èˆªæŽ¥å£
interface Category {
  title: string;
  icon: Resource;
  items: string[];
}

@Component
export struct BrowsePage {
  @State inspirations: Inspiration[] = [];
  @State filteredInspirations: Inspiration[] = [];
  @State selectedFilters: string[] = [];
  @State searchKeyword: string = '';
  @State isLoading: boolean = true;
  
  private dbManager = new NewDatabaseManager();
  private inspirationDAO: InspirationDAO = new InspirationDAO(this.dbManager);
  private dataInitializer: InspirationDataInitializer = new InspirationDataInitializer();
  
  // çƒ­é—¨æ ‡ç­¾é…ç½®ï¼ˆæ›¿ä»£åŽŸå¿«é€Ÿç­›é€‰å™¨ï¼‰
  private hotTags: QuickFilter[] = [
    { label: 'ðŸ’ ç”Ÿæ—¥å¿…å¤‡', type: 'occasion', value: 'ç”Ÿæ—¥' },
    { label: 'â¤ï¸ æƒ…ä¾£ä¸“å±ž', type: 'audience', value: 'æ‹äºº' },
    { label: 'ðŸŽ¨ DIYæ‰‹ä½œ', type: 'type', value: 'DIYæ‰‹ä½œ' },
    { label: 'ðŸ’° ç™¾å…ƒå¥½ç¤¼', type: 'budget', value: '200' },
    { label: 'ðŸŽ‰ èŠ‚æ—¥åº†ç¥', type: 'occasion', value: 'èŠ‚æ—¥' },
    { label: 'ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ å­æ•¬çˆ¶æ¯', type: 'audience', value: 'çˆ¶æ¯' }
  ];
  
  // åˆ†ç±»å¯¼èˆªé…ç½®ï¼ˆä¸°å¯Œæ•°æ®ï¼‰
  private categories: Category[] = [
    { 
      title: 'æŒ‰å¯¹è±¡é€', 
      icon: $r('app.media.icon_rq'),
      items: ['çˆ¶æ¯é•¿è¾ˆ', 'æ‹äººçˆ±äºº', 'é—ºèœœå¥½å‹', 'åŒäº‹é¢†å¯¼', 'å°æœ‹å‹', 'è€å¸ˆå¯¼å¸ˆ', 'å®¢æˆ·åˆä½œä¼™ä¼´', 'å…„å¼Ÿå§å¦¹', 'ç¥–çˆ¶æ¯', 'å²³çˆ¶å²³æ¯', 'æ–°æœ‹å‹', 'ç½‘å‹']
    },
    { 
      title: 'æŒ‰åœºåˆé€', 
      icon: $r('app.media.icon_ch'),
      items: ['ç”Ÿæ—¥åº†ç¥', 'ç»“å©šçºªå¿µ', 'æ‹çˆ±çºªå¿µæ—¥', 'æ¯•ä¸šå…¸ç¤¼', 'å‡èŒåŠ è–ª', 'ä¹”è¿æ–°å±…', 'æ–°ç”Ÿå„¿è¯žç”Ÿ', 'åº·å¤å‡ºé™¢', 'é“æ­‰å’Œè§£', 'æ„Ÿè°¢ç­”è°¢', 'èŠ‚æ—¥ç¥ç¦', 'å¼€ä¸šåº†å…¸']
    },
    { 
      title: 'æŒ‰å…´è¶£é€', 
      icon: $r('app.media.icon_xq'),
      items: ['ç¾Žé£Ÿçƒ¹é¥ª', 'é˜…è¯»å†™ä½œ', 'ç§‘æŠ€æ•°ç ', 'æ—…è¡Œæ‘„å½±', 'å¥èº«è¿åŠ¨', 'è‰ºæœ¯ç»˜ç”»', 'éŸ³ä¹èˆžè¹ˆ', 'æ¸¸æˆç”µç«ž', 'æ‰‹å·¥åˆ¶ä½œ', 'å›­è‰ºç§æ¤', 'æ”¶è—å¤çŽ©', 'æ—¶å°šç¾Žå¦†']
    },
    { 
      title: 'æŒ‰é¢„ç®—é€', 
      icon:  $r('app.media.icon_money'),
      items: ['50å…ƒä»¥ä¸‹', '50-100å…ƒ', '100-200å…ƒ', '200-500å…ƒ', '500-1000å…ƒ', '1000-2000å…ƒ', '2000-5000å…ƒ', '5000å…ƒä»¥ä¸Š']
    },
    { 
      title: 'æŒ‰ç±»åž‹é€', 
      icon: $r('app.media.icon_lx'),
      items: ['DIYæ‰‹ä½œ', 'ä½“éªŒæœåŠ¡', 'æ—¥ç”¨å®žç‰©', 'åˆ›æ„æ–°å¥‡', 'ç§‘æŠ€æ•°ç ', 'ç¾Žå¦†æŠ¤è‚¤', 'ä¹¦ç±æ–‡å…·', 'è¿åŠ¨æˆ·å¤–', 'å®¶å±…è£…é¥°', 'ç å®é¦–é¥°', 'æœè£…é…é¥°', 'ç¾Žé£Ÿç‰¹äº§']
    },
    {
       title: 'æŒ‰å­£èŠ‚é€',
       icon: $r('app.media.icon_rl'),
       items: ['æ˜¥å­£è¸é’', 'å¤æ—¥æ¸…å‡‰', 'ç§‹å­£æ¸©é¦¨', 'å†¬æ—¥æš–å¿ƒ', 'æƒ…äººèŠ‚', 'æ¯äº²èŠ‚', 'çˆ¶äº²èŠ‚', 'å„¿ç«¥èŠ‚', 'æ•™å¸ˆèŠ‚', 'ä¸­ç§‹èŠ‚', 'å›½åº†èŠ‚', 'åœ£è¯žèŠ‚']
     }
  ];

  aboutToAppear() {
    this.loadInspirations();
  }

  async loadInspirations() {
    try {
      this.isLoading = true;
      
      // åˆå§‹åŒ–é¢„ç½®æ•°æ®ï¼ˆå¦‚æžœéœ€è¦ï¼‰
      await this.dataInitializer.initializeAllData();
      
      this.inspirations = await this.inspirationDAO.getAllInspirations();
      
      // å¦‚æžœæ•°æ®åº“ä¸­æ²¡æœ‰æ•°æ®ï¼Œä½¿ç”¨é¢„ç½®æ•°æ®
      if (this.inspirations.length === 0) {
        this.inspirations = this.getMockInspirations();
      }
      
      this.filteredInspirations = this.inspirations;
    } catch (error) {
      console.error('åŠ è½½çµæ„Ÿæ•°æ®å¤±è´¥:', error);
      // å¦‚æžœæ•°æ®åº“ä¸ºç©ºï¼Œæ˜¾ç¤ºç¤ºä¾‹æ•°æ®
      this.inspirations = this.getMockInspirations();
      this.filteredInspirations = this.inspirations;
    } finally {
      this.isLoading = false;
    }
  }

  // èŽ·å–ç¤ºä¾‹çµæ„Ÿæ•°æ®
  getMockInspirations(): Inspiration[] {
    return [
      {
        id: '1',
        title: 'ä¸ºå¥¹å®šåˆ¶ä¸€æœ¬ä¸“å±žæ•…äº‹ä¹¦',
        description: 'æ”¶é›†ä½ ä»¬çš„ç¾Žå¥½å›žå¿†ï¼Œåˆ¶ä½œæˆç²¾ç¾Žçš„æ•…äº‹ä¹¦',
        detailedDescription: 'è¿™æ˜¯ä¸€ä»½å……æ»¡çˆ±æ„çš„ç¤¼ç‰©ï¼Œå°†ä½ ä»¬çš„ç‚¹ç‚¹æ»´æ»´è®°å½•ä¸‹æ¥ï¼Œåˆ¶ä½œæˆç‹¬ä¸€æ— äºŒçš„æ•…äº‹ä¹¦ã€‚å¯ä»¥åŒ…å«ç…§ç‰‡ã€æ–‡å­—ã€æ‰‹ç»˜æ’ç”»ç­‰å…ƒç´ ã€‚',
        images: ['/common/images/story_book.jpg'],
        tags: ['æµªæ¼«', 'çºªå¿µ', 'å®šåˆ¶', 'DIY'],
        targetAudience: ['æ‹äºº'],
        occasions: ['çºªå¿µæ—¥', 'ç”Ÿæ—¥', 'æƒ…äººèŠ‚'],
        interests: ['é˜…è¯»', 'è‰ºæœ¯'],
        budgetRange: { min: 200, max: 500, label: '200-500å…ƒ' },
        giftType: 'DIYæ‰‹ä½œ',
        difficulty: 'medium',
        timeRequired: '3-5å¤©',
        materials: ['ç›¸å†Œ', 'æ‰“å°ç…§ç‰‡', 'å½©ç¬”', 'è£…é¥°è´´çº¸'],
        steps: ['æ”¶é›†ç…§ç‰‡å’Œå›žå¿†', 'è®¾è®¡é¡µé¢å¸ƒå±€', 'æ‰“å°å’Œè£…è®¢', 'æ·»åŠ è£…é¥°å…ƒç´ '],
        tips: ['æå‰å‡†å¤‡ç…§ç‰‡', 'æ³¨æ„æŽ’ç‰ˆç¾Žè§‚', 'å¯ä»¥åŠ å…¥æ‰‹å†™æ–‡å­—'],
        isRecommended: true,
        createdAt: '2024-01-01T00:00:00Z'
      },
      {
        id: '2',
        title: 'äº²æ‰‹åˆ¶ä½œå¦ˆå¦ˆçš„å…»ç”ŸèŒ¶åŒ…',
        description: 'æ ¹æ®å¦ˆå¦ˆçš„ä½“è´¨ï¼Œè°ƒé…ä¸“å±žçš„å…»ç”ŸèŒ¶',
        detailedDescription: 'ä¸ºå¦ˆå¦ˆç²¾å¿ƒè°ƒé…çš„å…»ç”ŸèŒ¶åŒ…ï¼Œæ—¢å®žç”¨åˆè´´å¿ƒã€‚å¯ä»¥æ ¹æ®å­£èŠ‚å’Œå¦ˆå¦ˆçš„èº«ä½“çŠ¶å†µé€‰æ‹©ä¸åŒçš„èŒ¶æã€‚',
        images: ['/common/images/tea_package.jpg'],
        tags: ['å…»ç”Ÿ', 'å¥åº·', 'æ‰‹ä½œ', 'è´´å¿ƒ'],
        targetAudience: ['çˆ¶æ¯'],
        occasions: ['ç”Ÿæ—¥', 'æ¯äº²èŠ‚', 'æ—¥å¸¸å…³æ€€'],
        interests: ['å…»ç”Ÿ', 'èŒ¶è‰º'],
        budgetRange: { min: 50, max: 200, label: '50-200å…ƒ' },
        giftType: 'DIYæ‰‹ä½œ',
        difficulty: 'easy',
        timeRequired: '1-2å¤©',
        materials: ['å„ç§èŒ¶å¶', 'å°å¸ƒè¢‹', 'æ ‡ç­¾', 'åŒ…è£…ç›’'],
        steps: ['äº†è§£å¦ˆå¦ˆä½“è´¨', 'é€‰æ‹©åˆé€‚èŒ¶æ', 'æŒ‰æ¯”ä¾‹è°ƒé…', 'åŒ…è£…æˆå°è¢‹'],
        tips: ['å’¨è¯¢ä¸­åŒ»å»ºè®®', 'æ³¨æ„èŒ¶ææ­é…', 'åˆ¶ä½œç²¾ç¾Žæ ‡ç­¾'],
        isRecommended: true,
        createdAt: '2024-01-02T00:00:00Z'
      },
      {
        id: '3',
        title: 'æ™ºèƒ½æ‰‹çŽ¯å¥åº·ç®¡å®¶',
        description: 'é€ç»™çˆ±è¿åŠ¨çš„æœ‹å‹ï¼Œç›‘æµ‹å¥åº·æ•°æ®',
        detailedDescription: 'çŽ°ä»£äººè¶Šæ¥è¶Šæ³¨é‡å¥åº·ï¼Œä¸€æ¬¾å¥½çš„æ™ºèƒ½æ‰‹çŽ¯å¯ä»¥å¸®åŠ©æœ‹å‹æ›´å¥½åœ°ç®¡ç†å¥åº·ï¼Œè®°å½•è¿åŠ¨æ•°æ®ã€‚',
        images: ['/common/images/smart_watch.jpg'],
        tags: ['ç§‘æŠ€', 'å¥åº·', 'è¿åŠ¨', 'å®žç”¨'],
        targetAudience: ['æœ‹å‹', 'åŒäº‹'],
        occasions: ['ç”Ÿæ—¥', 'æ¯•ä¸š', 'å‡èŒ'],
        interests: ['å¥èº«', 'ç§‘æŠ€'],
        budgetRange: { min: 500, max: 1000, label: '500-1000å…ƒ' },
        giftType: 'ç§‘æŠ€æ•°ç ',
        difficulty: 'easy',
        timeRequired: 'å³ä¹°å³é€',
        isRecommended: false,
        createdAt: '2024-01-03T00:00:00Z'
      }
    ];
  }

  // åº”ç”¨ç­›é€‰
  applyFilters() {
    let result = this.inspirations;
    
    // æœç´¢å…³é”®è¯ç­›é€‰
    if (this.searchKeyword.trim()) {
      const keyword = this.searchKeyword.toLowerCase();
      result = result.filter(item => 
        item.title.toLowerCase().includes(keyword) ||
        item.description.toLowerCase().includes(keyword) ||
        item.tags.some(tag => tag.toLowerCase().includes(keyword))
      );
    }
    
    // çƒ­é—¨æ ‡ç­¾ç­›é€‰
    this.selectedFilters.forEach(filter => {
      const filterConfig = this.hotTags.find(f => f.label === filter);
      if (filterConfig) {
        switch (filterConfig.type) {
          case 'occasion':
            result = result.filter(item => item.occasions.includes(filterConfig.value));
            break;
          case 'audience':
            result = result.filter(item => item.targetAudience.includes(filterConfig.value));
            break;
          case 'budget':
            const budget = parseInt(filterConfig.value);
            result = result.filter(item => item.budgetRange.max <= budget);
            break;
          case 'type':
            result = result.filter(item => item.giftType === filterConfig.value);
            break;
        }
      }
    });
    
    this.filteredInspirations = result;
  }

  // åˆ‡æ¢ç­›é€‰å™¨
  toggleFilter(filterLabel: string) {
    const index = this.selectedFilters.indexOf(filterLabel);
    if (index > -1) {
      this.selectedFilters.splice(index, 1);
    } else {
      this.selectedFilters.push(filterLabel);
    }
    this.applyFilters();
  }

  // å¯¼èˆªåˆ°åˆ†ç±»é¡µé¢
  navigateToCategory(category: Category) {
    try {
      // è·³è½¬åˆ°ç­›é€‰é¡µé¢ï¼Œä¼ é€’åˆ†ç±»ä¿¡æ¯
      router.pushUrl({
        url: 'pages/tabs/InspirationFilterPage',
        params: {
          filterType: 'category',
          filterValue: category.title,
          title: category.title,
          categoryItems: category.items
        }
      });
      
      console.log('å¯¼èˆªåˆ°åˆ†ç±»é¡µé¢:', category.title);
    } catch (error) {
      console.error('å¯¼èˆªå¤±è´¥:', error);
      
      // å¦‚æžœå¯¼èˆªå¤±è´¥ï¼Œåˆ™åœ¨å½“å‰é¡µé¢åº”ç”¨ç­›é€‰
      this.selectedFilters = [];
      this.searchKeyword = '';
      
      // æ ¹æ®åˆ†ç±»è®¾ç½®ç›¸åº”çš„ç­›é€‰æ¡ä»¶
      switch (category.title) {
        case 'æŒ‰å¯¹è±¡é€':
          this.selectedFilters = ['ðŸ‘¨â€ðŸ‘©â€ðŸ‘§â€ðŸ‘¦ å­æ•¬çˆ¶æ¯', 'â¤ï¸ æƒ…ä¾£ä¸“å±ž'];
          break;
        case 'æŒ‰åœºåˆé€':
          this.selectedFilters = ['ðŸ’ ç”Ÿæ—¥å¿…å¤‡', 'ðŸŽ‰ èŠ‚æ—¥åº†ç¥'];
          break;
        case 'æŒ‰é¢„ç®—é€':
          this.selectedFilters = ['ðŸ’° ç™¾å…ƒå¥½ç¤¼'];
          break;
        case 'æŒ‰ç±»åž‹é€':
          this.selectedFilters = ['ðŸŽ¨ DIYæ‰‹ä½œ'];
          break;
        case 'æŒ‰å…´è¶£é€':
        case 'æŒ‰å­£èŠ‚é€':
          this.selectedFilters = ['ðŸŽ‰ èŠ‚æ—¥åº†ç¥'];
          break;
      }
      
      this.applyFilters();
      console.log('åœ¨å½“å‰é¡µé¢åº”ç”¨ç­›é€‰:', category.title, this.selectedFilters);
    }
  }

  // å¯¼èˆªåˆ°çµæ„Ÿè¯¦æƒ…é¡µ
  navigateToInspirationDetail(inspiration: Inspiration) {
    router.pushUrl({
      url: 'pages/InspirationDetailPage',
      params: {
        inspirationId: inspiration.id
      }
    });
  }

  // å¯¼èˆªåˆ°ç­›é€‰é¡µé¢
  navigateToFilter(filterType: string, filterValue: string, title?: string) {
    router.pushUrl({
      url: 'pages/tabs/InspirationFilterPage',
      params: {
        filterType: filterType,
        filterValue: filterValue,
        title: title || filterValue
      }
    });
  }

  build() {
    Column() {
      // é¡¶éƒ¨æœç´¢æ 
      Row() {
        TextInput({ placeholder: 'æœç´¢çµæ„Ÿåˆ›æ„...' })
          .layoutWeight(1)
          .height(40)
          .borderRadius(20)
          .backgroundColor('#F0F0F0')
          .padding({ left: 16, right: 16 })
          .onChange((value: string) => {
            this.searchKeyword = value;
            this.applyFilters();
          })
      }
      .width('100%')
      .padding({ left: 16, right: 16, top: 12, bottom: 12 })
      .backgroundColor(Color.White)

      if (this.isLoading) {
        // åŠ è½½çŠ¶æ€
        Column() {
          LoadingProgress()
            .width(50)
            .height(50)
            .color('#FF6B35')
          
          Text('åŠ è½½ä¸­...')
            .fontSize(14)
            .fontColor('#666666')
            .margin({ top: 12 })
        }
        .width('100%')
        .height('60%')
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
      } else {
        Scroll() {
          Column() {
            // çƒ­é—¨æ ‡ç­¾
            Column() {
              Text('ðŸ”¥ çƒ­é—¨æŽ¨è')
                .fontSize(16)
                .fontWeight(FontWeight.Medium)
                .margin({ bottom: 12 })
                .alignSelf(ItemAlign.Start)
              
              Flex({ wrap: FlexWrap.Wrap, justifyContent: FlexAlign.Start }) {
                ForEach(this.hotTags, (tag: QuickFilter) => {
                  Button(tag.label)
                    .fontSize(12)
                    .height(32)
                    .padding({ left: 12, right: 12 })
                    .margin({ right: 8, bottom: 8 })
                    .backgroundColor(this.selectedFilters.includes(tag.label) ? '#FF6B35' : '#F0F0F0')
                    .fontColor(this.selectedFilters.includes(tag.label) ? Color.White : '#333333')
                    .borderRadius(16)
                    .onClick(() => {
                      this.toggleFilter(tag.label);
                    })
                })
              }
            }
            .width('100%')
            .padding(16)
            .backgroundColor(Color.White)
            .margin({ bottom: 8 })

            // åˆ†ç±»å¯¼èˆª
            Column() {
              Text('ðŸŽ¯ ç²¾å‡†åˆ†ç±»')
                .fontSize(16)
                .fontWeight(FontWeight.Medium)
                .margin({ bottom: 12 })
                .alignSelf(ItemAlign.Start)
              
              Grid() {
                ForEach(this.categories, (category: Category) => {
                  GridItem() {
                    Column() {
                      Image(category.icon)
                        .width(24)
                        .height(24)
                        .margin({ bottom: 4 })
                      
                      Text(category.title)
                        .fontSize(14)
                        .fontColor('#333333')
                        .textAlign(TextAlign.Center)
                    }
                    .width('100%')
                    .height(80)
                    .justifyContent(FlexAlign.Center)
                    .alignItems(HorizontalAlign.Center)
                    .backgroundColor('#F8F9FA')
                    .borderRadius(12)
                    .onClick(() => {
                      this.navigateToCategory(category);
                    })
                  }
                })
              }
              .columnsTemplate('1fr 1fr')
              .rowsTemplate('1fr 1fr 1fr')
              .rowsGap(12)
              .columnsGap(12)
              .height(288)
            }
            .width('100%')
            .padding(16)
            .backgroundColor(Color.White)
            .margin({ bottom: 8 })

            // çµæ„ŸæŽ¨èåˆ—è¡¨
            Column() {
              Row() {
                Text('çµæ„ŸæŽ¨è')
                  .fontSize(16)
                  .fontWeight(FontWeight.Medium)
                
                Blank()
                
                Text(`å…±${this.filteredInspirations.length}ä¸ªåˆ›æ„`)
                  .fontSize(12)
                  .fontColor('#666666')
              }
              .width('100%')
              .margin({ bottom: 12 })
              
              if (this.filteredInspirations.length === 0) {
                Column() {
                  Image($r('app.media.icon_search'))
              .width(64)
              .height(64)
              .fillColor('#CCCCCC')
              .margin({ bottom: 16 }) // å¢žåŠ åº•éƒ¨é—´è·
                  
                  Text('æš‚æ— åŒ¹é…çš„çµæ„Ÿ')
                    .fontSize(16)
                    .fontColor('#666666')
                    .margin({ bottom: 12 }) // å¢žåŠ åº•éƒ¨é—´è·
                  
                  Text('è¯•è¯•è°ƒæ•´ç­›é€‰æ¡ä»¶æˆ–æœç´¢å…³é”®è¯')
                    .fontSize(14)
                    .fontColor('#999999')
                }
                .width('100%')
                .height(200)
                .justifyContent(FlexAlign.Center)
                .alignItems(HorizontalAlign.Center)
                .padding({ left: 24, right: 24 }) // æ·»åŠ æ°´å¹³å†…è¾¹è·
              } else {
                ForEach(this.filteredInspirations, (inspiration: Inspiration) => {
                  this.buildInspirationCard(inspiration)
                })
              }
            }
            .width('100%')
            .padding(16)
            .backgroundColor(Color.White)
          }
        }
        .layoutWeight(1)
        .scrollBar(BarState.Off)
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F8F9FA')
  }

  @Builder
  buildInspirationCard(inspiration: Inspiration) {
    Column() {
      Row() {
        Column() {
          Text(inspiration.title)
            .fontSize(16)
            .fontWeight(FontWeight.Medium)
            .fontColor('#333333')
            .maxLines(2)
            .textOverflow({ overflow: TextOverflow.Ellipsis })
            .margin({ bottom: 8 })
          
          Text(inspiration.description)
            .fontSize(14)
            .fontColor('#666666')
            .maxLines(2)
            .textOverflow({ overflow: TextOverflow.Ellipsis })
            .margin({ bottom: 12 })
          
          // æ ‡ç­¾
          Flex({ wrap: FlexWrap.Wrap, justifyContent: FlexAlign.Start }) {
            ForEach(inspiration.tags.slice(0, 3), (tag: string) => {
              Text(`#${tag}`)
                .fontSize(10)
                .fontColor('#FF6B35')
                .backgroundColor('#FFF0ED')
                .padding({ left: 6, right: 6, top: 2, bottom: 2 })
                .borderRadius(4)
                .margin({ right: 4, bottom: 4 })
            })
          }
          
          // é¢„ç®—å’Œéš¾åº¦
          Row() {
            Text(inspiration.budgetRange.label)
              .fontSize(12)
              .fontColor('#FF6B35')
              .fontWeight(FontWeight.Medium)
            
            Text('|')
              .fontSize(12)
              .fontColor('#CCCCCC')
              .margin({ left: 8, right: 8 })
            
            Text(inspiration.difficulty === 'easy' ? 'ç®€å•' : inspiration.difficulty === 'medium' ? 'ä¸­ç­‰' : 'å›°éš¾')
              .fontSize(12)
              .fontColor('#666666')
          }
          .margin({ top: 8 })
        }
        .layoutWeight(1)
        .alignItems(HorizontalAlign.Start)
        
        // ç¼©ç•¥å›¾å ä½
        Column() {
          Image($r('app.media.ic_gift_placeholder'))
                 .width(60)
                 .height(60)
        }
        .width(80)
        .height(80)
        .backgroundColor('#F0F0F0')
        .borderRadius(8)
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center)
        .margin({ left: 16 }) // å¢žåŠ å·¦è¾¹è·
      }
      .width('100%')
      .alignItems(VerticalAlign.Top)
    }
    .width('100%')
    .padding(16)
    .backgroundColor(Color.White)
    .borderRadius(12)
    .margin({ bottom: 16 }) // å¢žåŠ åº•éƒ¨é—´è·
    .shadow({ radius: 4, color: '#1A000000', offsetX: 0, offsetY: 2 }) // æ·»åŠ é˜´å½±æ•ˆæžœ
    .onClick(() => {
      this.navigateToInspirationDetail(inspiration);
    })
  }
}